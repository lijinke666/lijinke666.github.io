<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="李金珂,jkli@thoughtworks.com"><title>黄瓜 ui -  一个 即插即用的 React UI 组件库 · 李金珂的小屋</title><meta name="description" content="1. 前言
2018年马上结束啦, 今年是 充实忙碌的一年啊, 年中有一天脑壳一热,突然想开发一个 React 组件库, 之前偶尔写过一些 小玩具, 所以想能不能写一个 大玩具呢? 庆幸自己不是三分钟热度, 花了三个月时间, 周末,和工作日休息时间, 搞了一个 cuke-ui 在这里,记录一下心得吧"><meta name="keywords" content="Javascript,Node.js"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="李金珂的小屋"><meta name="icon" content="/logos/logo_192.png"><meta name="apple-touch-icon" content="/logos/logo_192.png"><meta name="apple-touch-icon-precomposed" content="/logos/logo_192.png"><meta name="apple-touch-startup-image" content="/logos/logo_192.png"><meta name="Alipay:title" content="李金珂的小屋"><meta name="Alipay:imgUrl" content="/logos/logo_192.png"><meta name="Alipay:desc" content="要想学仙术哪能不吃苦"><meta name="renderer" content="webkit"><meta name="theme-color" content="#fff"><link rel="short icon" href="/logos/logo_192.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><link rel="manifest" href="/manifest.json"><meta name="generator" content="Hexo 4.2.1"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/my.jpeg" style="width:127px;border-radius:50%;margin-bottom:20px;"><h3 title=""><a href="/">李金珂的小屋</a></h3><div class="description"><p>要想学仙术,哪能不吃苦</p></div></div></div><ul class="social-links"><li><a href="http://weibo.com/金珂珂珂珂" target="_blank" rel="noopener"><i class="fa fa-weibo"></i></a></li><li><a href="http://github.com/lijinke666" target="_blank" rel="noopener"><i class="fa fa-github"></i></a></li></ul><div class="footer"><a target="_blank" href="/"><span>Theme by</span></a><a href="https://www.caicai.me" target="_blank" rel="noopener"> CaiCai</a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole" target="_blank" rel="noopener"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a><a href="http://www.beian.miit.gov.cn/" target="_blank">蜀ICP备17033638号</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">主页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友情链接</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/my.jpeg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>黄瓜 ui -  一个 即插即用的 React UI 组件库</a></h3></div><div class="post-content"><h3 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h3><hr>
<p>2018年马上结束啦, 今年是 充实忙碌的一年啊, 年中有一天脑壳一热,突然想开发一个 <code>React</code> 组件库, 之前偶尔写过一些 小玩具, 所以想能不能写一个 大玩具呢? 庆幸自己不是三分钟热度, 花了三个月时间, 周末,和工作日休息时间, 搞了一个 cuke-ui 在这里,记录一下心得吧</p>
<p><a href="https://github.com/cuke-ui/cuke-ui" target="_blank" rel="noopener">GITHUB</a> |<br><a href="https://cuke-ui.github.io/cuke-ui-landing/" target="_blank" rel="noopener">官网</a></p>
<h3 id="2-组件化"><a href="#2-组件化" class="headerlink" title="2. 组件化"></a>2. 组件化</h3><hr>
<p>2011年 我还在读初中, <code>Twitter</code> 的两位大佬,由于 老板给他们安排的工作太多了,很多重复性的东西, 由于他们太懒了, 一不小心就 开发了 <code>Bootstrap</code>, 这个东西不用多说, 虽然我不太喜欢, 但是它无疑是 最火,最早的一批 前端 Ui 库, 也是在那时候,我认识到, 能 <code>CV</code> 编程 尽量 不 BB 的重要性</p>
<p>到现在 三大框架 一统天下, 组件 成了不可或缺的一部分, 各种 <code>UI</code> 库 层出不穷. 最火的还是当属 <code>antd</code> , 于是 我觉得 借鉴 (抄袭) 一波, 开始干活了</p>
<h3 id="3-搭建项目"><a href="#3-搭建项目" class="headerlink" title="3. 搭建项目"></a>3. 搭建项目</h3><p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-134943@2x.png" alt="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-134943@2x.png"></p>
<ul>
<li><code>.storebook</code> storebook 的一些配置</li>
<li><code>components</code> 参考的 antd, 放置所有组件</li>
<li><code>scripts</code> 发布,打包,相关的一些脚本</li>
<li><code>stories</code>项目静态文档,负责 demo 演示</li>
<li><code>tests</code> 测试相关的一些 <code>setup</code></li>
</ul>
<p>其他就没啥说的, 全是一些常规文件, 不得不吐槽 现在搭个项目 需要的配置文件越来越多了</p>
<h4 id="3-1-storybook-搭建网站"><a href="#3-1-storybook-搭建网站" class="headerlink" title="3.1 storybook 搭建网站"></a>3.1 storybook 搭建网站</h4><p>一个组件库 肯定需要一个 演示 demo 的静态网站 ,比如 <a href="https://ant.design/components/button-cn/" target="_blank" rel="noopener">antd 的 Button</a> 对比了一下, 选了一个 比较简单的 <code>storebook</code> 来搭建网站</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span></span><br><span class="line"><span class="keyword">import</span> &#123; configure, addDecorator &#125; <span class="keyword">from</span> <span class="string">'@storybook/react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; name, repository &#125; <span class="keyword">from</span> <span class="string">"../package.json"</span></span><br><span class="line"><span class="keyword">import</span> &#123; withInfo &#125; <span class="keyword">from</span> <span class="string">'@storybook/addon-info'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withNotes &#125; <span class="keyword">from</span> <span class="string">'@storybook/addon-notes'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; configureActions &#125; <span class="keyword">from</span> <span class="string">'@storybook/addon-actions'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; withOptions &#125; <span class="keyword">from</span> <span class="string">'@storybook/addon-options'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; version &#125; <span class="keyword">from</span> <span class="string">'../package.json'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'@storybook/addon-console'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"../components/styles/index.less"</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"../stories/styles/code.less"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadStories</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 介绍</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/index'</span>);</span><br><span class="line">  <span class="comment">// 普通</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/general'</span>);</span><br><span class="line">  <span class="comment">// 视听娱乐</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/player'</span>);</span><br><span class="line">  <span class="comment">// 导航</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/navigation'</span>)</span><br><span class="line">  <span class="comment">// 数据录入</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/dataEntry'</span>);</span><br><span class="line">  <span class="comment">// 数据展示</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/dataDisplay'</span>);</span><br><span class="line">  <span class="comment">// 布局</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/grid'</span>);</span><br><span class="line">  <span class="comment">// 操作反馈</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/feedback'</span>);</span><br><span class="line">  <span class="comment">// 其他</span></span><br><span class="line">  <span class="built_in">require</span>(<span class="string">'../stories/other'</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">configureActions(&#123;</span><br><span class="line">  depth: <span class="number">100</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">addDecorator(withInfo(&#123;</span><br><span class="line">  header: <span class="literal">true</span>,</span><br><span class="line">  maxPropsIntoLine: <span class="number">100</span>,</span><br><span class="line">  maxPropObjectKeys: <span class="number">100</span>,</span><br><span class="line">  maxPropArrayLength: <span class="number">100</span>,</span><br><span class="line">  maxPropStringLength: <span class="number">100</span>,</span><br><span class="line">&#125;))</span><br><span class="line">addDecorator(withNotes);</span><br><span class="line">addDecorator(withOptions(&#123;</span><br><span class="line">  name: <span class="string">`<span class="subst">$&#123;name&#125;</span> v<span class="subst">$&#123;version&#125;</span>`</span>,</span><br><span class="line">  url: repository,</span><br><span class="line">  sidebarAnimations: <span class="literal">true</span>,</span><br><span class="line">&#125;))</span><br><span class="line"></span><br><span class="line">addDecorator(<span class="function"><span class="params">story</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">padding:</span> "<span class="attr">0</span> <span class="attr">60px</span> <span class="attr">50px</span>" &#125;&#125;&gt;</span>&#123;story()&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">configure(loadStories, <span class="built_in">module</span>);</span><br></pre></td></tr></table></figure>

<p>编写 <code>stories</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; storiesOf &#125; <span class="keyword">from</span> <span class="string">'@storybook/react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; action &#125; <span class="keyword">from</span> <span class="string">'@storybook/addon-actions'</span>;</span><br><span class="line"><span class="keyword">import</span> Button <span class="keyword">from</span> <span class="string">'../components/button'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./styles/button.less'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"../components/button/styles.less"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; SuccessIcon &#125; <span class="keyword">from</span> <span class="string">'../components/icon'</span>;</span><br><span class="line"></span><br><span class="line">storiesOf(<span class="string">'普通'</span>, <span class="built_in">module</span>).add(</span><br><span class="line">  <span class="string">'Button 按钮'</span>,</span><br><span class="line">  () =&gt; (</span><br><span class="line">    &lt;div className=<span class="string">"button-example"</span>&gt;</span><br><span class="line">      &lt;h2&gt;基本使用&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">      &lt;Button onClick=&#123;action('clicked')&#125;&gt;默认&lt;/</span>Button&gt;</span><br><span class="line">     &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">)</span></span><br></pre></td></tr></table></figure>

<p>再配合 <code>webpack.config.js</code> 就基本完事了, 配置就不贴了, 常规操作</p>
<p>这时候 看效果</p>
<p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-140129@2x.png" alt="WX20181226-140129@2x.png"></p>
<p>哇塞, 好像是那么回事, 美滋滋, 这里虽然几句话 就讲完了, 实际我撸的时候 , 还是遇到了很多 很繁琐的麻烦, 比如 <code>webpack4</code> <code>babel@7.x</code> 与 <code>storybook</code> 版本不兼容啊 之类的, 各种搜 <code>issue</code> 啊, 好在最后解决了</p>
<p><code>storybook</code> 提供了 一个 静态发布 插件 , 这样解决了我最后一个问题, 发布到 github 的 <code>gh-page</code> , 添加两行 <code>npm scripts</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;start&quot;: &quot;yarn dev&quot;,</span><br><span class="line">    &quot;clean&quot;: &quot;rimraf dist &amp;&amp; rimraf lib&quot;,</span><br><span class="line">    &quot;dev&quot;: &quot;start-storybook -p 8080 -c .storybook&quot;,</span><br><span class="line">    &quot;build:docs&quot;: &quot;build-storybook -c .storybook -o .out&quot;,</span><br><span class="line">    &quot;pub:docs&quot;: &quot;yarn build:docs &amp;&amp; storybook-to-ghpages --existing-output-dir&#x3D;.out&quot;,</span><br><span class="line">&#125;</span><br><span class="line">&quot;storybook-deployer&quot;: &#123;</span><br><span class="line">    &quot;gitUsername&quot;: &quot;cuke-ui&quot;,</span><br><span class="line">    &quot;gitEmail&quot;: &quot;xx@xx.com&quot;,</span><br><span class="line">    &quot;commitMessage&quot;: &quot;docs: deploy docs&quot;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>

<p>然后运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn pub:docs</span><br></pre></td></tr></table></figure>


<p>原理很简单,先通过 <code>webpack</code> 打包文档, 然后 <code>git add .</code> 然后 <code>push</code> 当 远端的 <code>gh-pages</code> 分支,</p>
<p>可以通过 <code>repo</code> =&gt; <code>Setting</code> =&gt; <code>Github Pages</code> 看到当前 部署好的 静态网站</p>
<p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-140844@2x.png" alt="WX20181226-140129@2x.png"></p>
<h4 id="3-2-开始编写组件"><a href="#3-2-开始编写组件" class="headerlink" title="3.2 开始编写组件"></a>3.2 开始编写组件</h4><p>网站搭好了, 相当于买好了 厨房用具, 可以开始 炒菜了, 菜在哪里? 好吧, 还要自己种菜, 现在我们 开始 种 <code>Button</code> 这个菜</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd components &amp;&amp; mkdir button</span><br></pre></td></tr></table></figure>

<p>在 <code>components</code> 目录 下 新建一个 <code>button</code> 目录</p>
<ul>
<li><code>__tests__</code>       // 测试<ul>
<li><code>index.test.js</code></li>
</ul>
</li>
<li><code>index.js</code>        //组件入口</li>
<li><code>styles.less</code>     //组件样式</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React, &#123; PureComponent &#125; <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">"prop-types"</span>;</span><br><span class="line"><span class="keyword">import</span> cls <span class="keyword">from</span> <span class="string">"classnames"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 具体代码</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>// styles.less</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@import &quot;..&#x2F;styles&#x2F;vars.less&quot;;</span><br><span class="line">@import &quot;..&#x2F;styles&#x2F;animate.less&quot;;</span><br><span class="line">@import &quot;..&#x2F;styles&#x2F;mixins.less&quot;;</span><br><span class="line">@prefixCls : cuke-button;</span><br><span class="line">.@&#123;prefixCls&#125; &#123;</span><br><span class="line">  &#x2F;&#x2F; 具体样式</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; index.test.js</span><br><span class="line"></span><br><span class="line">import React from &quot;react&quot;;</span><br><span class="line">import assert from &quot;power-assert&quot;;</span><br><span class="line">import &#123; render, shallow &#125; from &quot;enzyme&quot;;</span><br><span class="line">import toJson from &quot;enzyme-to-json&quot;;</span><br><span class="line">import Button from &quot;..&#x2F;index&quot;;</span><br><span class="line"></span><br><span class="line">describe(&quot;&lt;Button&#x2F;&gt;&quot;, () &#x3D;&gt; &#123;</span><br><span class="line">  it(&quot;should render a &lt;Button&#x2F;&gt; components&quot;, () &#x3D;&gt; &#123;</span><br><span class="line">    const wrapper &#x3D; render(</span><br><span class="line">    &lt;Button&gt;你好&lt;&#x2F;Button&gt;</span><br><span class="line">    )</span><br><span class="line">    expect(toJson(wrapper)).toMatchSnapshot();</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>


<p>这样就写好了 组件了, 我们假设 这个组件库暂时只有一个 <code>Button</code> 组件, 最后只剩一件事 , 发布到 <code>npm</code></p>
<p>让用户 可以向下面这样使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import &#123; Button &#125; from &quot;cuke-ui&quot;</span><br><span class="line">import &quot;cuke-ui&#x2F;dist&#x2F;cuke-ui.min.css&quot;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;Button&gt;你好&lt;&#x2F;Button&gt;,</span><br><span class="line">    document.getElementById(&#39;root&#39;)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h4 id="3-3-编写打包配置"><a href="#3-3-编写打包配置" class="headerlink" title="3.3 编写打包配置"></a>3.3 编写打包配置</h4><p>通常组件库 会提供两种 引入的方式</p>
<ol>
<li><p>通过 babel 打包的方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">babel components -d lib</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过 script 标签引入的 <code>UMD</code> 通用模块规范</p>
</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;cuke-ui@latest&#x2F;dist&#x2F;cuke-ui.min.css&quot;&gt;</span><br><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;https:&#x2F;&#x2F;unpkg.com&#x2F;cuke-ui@latest&#x2F;dist&#x2F;cuke-ui.min.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure>

<p>我以前写 插件的时候 只用过 第一种方式, 第二种也是放各种开源项目的代码才知道 原来可以通过 <code>webpack</code> 打包 <code>umd</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; scripts&#x2F;build.umd.js</span><br><span class="line"></span><br><span class="line">const config &#x3D; &#123;</span><br><span class="line">  mode: &quot;production&quot;,</span><br><span class="line">  entry: &#123;</span><br><span class="line">    [name]: [&quot;.&#x2F;components&#x2F;index.js&quot;]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  &#x2F;&#x2F;umd 模式打包</span><br><span class="line">  output: &#123;</span><br><span class="line">    library: name,</span><br><span class="line">    libraryTarget: &quot;umd&quot;,</span><br><span class="line">    umdNamedDefine: true, &#x2F;&#x2F; 是否将模块名称作为 AMD 输出的命名空间</span><br><span class="line">    path: path.join(process.cwd(), &quot;dist&quot;),</span><br><span class="line">    filename: &quot;[name].min.js&quot;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports &#x3D; config</span><br></pre></td></tr></table></figure>

<p>这里 使用 <code>webpack4</code> 所以指定 <code>mode</code> 为 生产环境, 自动帮你优化, 重点说下 <code>entry</code> 和 <code>output</code></p>
<p>找到打包入口 <code>componnets</code> 下面的 <code>index.js</code> , 然后 输入到 <code>dist</code> 目录, 生成一个  <code>cuke-ui.min.js</code>,</p>
<p>这时候发现 其实我们差一个 入口文件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/index.js</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> Button &#125; <span class="keyword">from</span> <span class="string">"./button"</span>;</span><br></pre></td></tr></table></figure>

<p>这里 把 默认模块 导出 取了一个别名,好处就是 可以统一管理 暴露给用户的 组件名字</p>
<p>最后 我们 在 <code>npm scripts</code> 添加一条命令, 不用每次手动去打包</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;clean&quot;: &quot;rimraf dist &amp;&amp; rimraf lib&quot;,</span><br><span class="line">&quot;build&quot;: &quot;yarn run clean &amp;&amp; yarn build:lib &amp;&amp; yarn build:umd &amp;&amp; yarn build:css&quot;,</span><br><span class="line">&quot;build:css&quot;: &quot;cd scripts &amp;&amp; gulp&quot;,</span><br><span class="line">&quot;build:lib&quot;: &quot;babel components -d lib&quot;,</span><br><span class="line">&quot;build:umd&quot;: &quot;webpack --config .&#x2F;scripts&#x2F;build.umd.js&quot;,</span><br></pre></td></tr></table></figure>

<ul>
<li><code>clean</code> 是为了 防止 dist 和 lib 目录有无修改的情况, 每次打包前先删除,</li>
<li><code>build:lib</code> 通过 babel 打包到 <code>es</code> 模块到 <code>lib</code> 目录</li>
<li><code>build:umd</code> 刚才已经解释过了</li>
</ul>
<p>这时候 运行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn build</span><br></pre></td></tr></table></figure>

<p>js 相关的部分倒是没问题了, 现在以及可以直接使用了</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'./lib'</span></span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=<span class="string">"module"</span>&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;Button&#125; <span class="keyword">from</span> <span class="string">"https://unpkg.com/cuke-ui@latest/dist/cuke-ui.min.js"</span></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>

<p>这时候会发现其实 还缺少对 css 的打包, 再加把劲, 加上 <code>gulp</code> 的配置</p>
<p>这一段配置 抄袭的 <a href="https://github.com/JeromeLin/dragon-ui" target="_blank" rel="noopener">dragon-ui</a> 的 配置, 稍微改了下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">const path &#x3D; require(&#39;path&#39;);</span><br><span class="line">const gulp &#x3D; require(&#39;gulp&#39;);</span><br><span class="line">const concat &#x3D; require(&#39;gulp-concat&#39;);</span><br><span class="line">const less &#x3D; require(&#39;gulp-less&#39;);</span><br><span class="line">const autoprefixer &#x3D; require(&#39;gulp-autoprefixer&#39;);</span><br><span class="line">const cssnano &#x3D; require(&#39;gulp-cssnano&#39;);</span><br><span class="line">const size &#x3D; require(&#39;gulp-filesize&#39;);</span><br><span class="line">const sourcemaps &#x3D; require(&#39;gulp-sourcemaps&#39;);</span><br><span class="line">const rename &#x3D; require(&#39;gulp-rename&#39;);</span><br><span class="line">const &#123; name &#125; &#x3D; require(&#39;..&#x2F;package.json&#39;)</span><br><span class="line">const browserList &#x3D; [</span><br><span class="line">  &quot;last 2 versions&quot;, &quot;Android &gt;&#x3D; 4.0&quot;, &quot;Firefox ESR&quot;, &quot;not ie &lt; 9&quot;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">const DIR &#x3D; &#123;</span><br><span class="line">  less: path.resolve(__dirname, &#39;..&#x2F;components&#x2F;**&#x2F;*.less&#39;),</span><br><span class="line">  buildSrc: [</span><br><span class="line">    path.resolve(__dirname, &#39;..&#x2F;components&#x2F;**&#x2F;styles.less&#39;),</span><br><span class="line">    path.resolve(__dirname, &#39;..&#x2F;components&#x2F;**&#x2F;index.less&#39;),</span><br><span class="line">  ],</span><br><span class="line">  lib: path.resolve(__dirname, &#39;..&#x2F;lib&#39;),</span><br><span class="line">  dist: path.resolve(__dirname, &#39;..&#x2F;dist&#39;),</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">gulp.task(&#39;copyLess&#39;, () &#x3D;&gt; &#123;</span><br><span class="line">  return gulp.src(DIR.less)</span><br><span class="line">    .pipe(gulp.dest(DIR.lib));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(&#39;dist&#39;, () &#x3D;&gt; &#123;</span><br><span class="line">  return gulp.src(DIR.buildSrc)</span><br><span class="line">    .pipe(sourcemaps.init())</span><br><span class="line">    .pipe(less(&#123;</span><br><span class="line">      outputStyle: &#39;compressed&#39;,</span><br><span class="line">    &#125;))</span><br><span class="line">    .pipe(autoprefixer(&#123; browsers: browserList &#125;))</span><br><span class="line">    .pipe(concat(&#96;$&#123;name&#125;.css&#96;))</span><br><span class="line">    .pipe(size())</span><br><span class="line">    .pipe(gulp.dest(DIR.dist))</span><br><span class="line">    .pipe(sourcemaps.write())</span><br><span class="line">    .pipe(rename(&#96;$&#123;name&#125;.css.map&#96;))</span><br><span class="line">    .pipe(size())</span><br><span class="line">    .pipe(gulp.dest(DIR.dist))</span><br><span class="line"></span><br><span class="line">    .pipe(cssnano())</span><br><span class="line">    .pipe(concat(&#96;$&#123;name&#125;.min.css&#96;))</span><br><span class="line">    .pipe(size())</span><br><span class="line">    .pipe(gulp.dest(DIR.dist))</span><br><span class="line">    .pipe(sourcemaps.write())</span><br><span class="line">    .pipe(rename(&#96;$&#123;name&#125;.min.css.map&#96;))</span><br><span class="line">    .pipe(size())</span><br><span class="line">    .pipe(gulp.dest(DIR.dist));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.task(&#39;default&#39;, [&#39;copyLess&#39;, &#39;dist&#39;]);</span><br></pre></td></tr></table></figure>

<p>这段代码 找到 components 下面 所有 的 less 文件 压缩编译后, 打包到 <code>dist</code> 目录 , 生成 <code>cuke-ui.min.css</code> 文件</p>
<h3 id="4-发布组件"><a href="#4-发布组件" class="headerlink" title="4. 发布组件"></a>4. 发布组件</h3><p>相信大家都知道怎么发布 <code>npm</code> 包 这里就不在赘述, 大概贴下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; package.json</span><br><span class="line"> &quot;name&quot;: &quot;cuke-ui&quot;,</span><br><span class="line">  &quot;version&quot;: &quot;1.2.1&quot;,</span><br><span class="line">  &quot;main&quot;: &quot;lib&#x2F;index.js&quot;,</span><br><span class="line">  &quot;description&quot;: &quot;A React.js UI components for Web&quot;,</span><br><span class="line">  &quot;repository&quot;: &quot;https:&#x2F;&#x2F;github.com&#x2F;cuke-ui&#x2F;cuke-ui.git&quot;,</span><br><span class="line">  &quot;homepage&quot;: &quot;https:&#x2F;&#x2F;cuke-ui.github.io&#x2F;cuke-ui-landing&#x2F;&quot;,</span><br><span class="line">  &quot;author&quot;: &quot;Jinke.Li &lt;jkli@thoughtWorks.com&gt;&quot;,</span><br><span class="line">  &quot;license&quot;: &quot;MIT&quot;,</span><br><span class="line">  &quot;private&quot;: false,</span><br><span class="line">  &quot;files&quot;: [</span><br><span class="line">    &quot;lib&quot;,</span><br><span class="line">    &quot;dist&quot;,</span><br><span class="line">    &quot;LICENSE&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;scripts&quot;: &#123;</span><br><span class="line">    &quot;prepublish&quot;: &quot;yarn build&quot;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>指定 该 库的 根目录是 <code>lib/index.js</code></p>
<p>当用户 <code>yarn add cuke-ui</code> 之后 使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123;Button&#125; from &#39;cuke-ui&#39;</span><br></pre></td></tr></table></figure>

<p>可以理解为 对应的是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#123;Button&#125; from &#39;.&#x2F;node_modules&#x2F;cuke-ui&#x2F;lib&#x2F;index.js&#39;</span><br></pre></td></tr></table></figure>

<p>编写相关相关的描述后就可以发布了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish .</span><br></pre></td></tr></table></figure>

<p>如果是测试版, 加一个 <code>--tag</code> 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish . --tag&#x3D;next</span><br></pre></td></tr></table></figure>

<h3 id="5-编写其余组件"><a href="#5-编写其余组件" class="headerlink" title="5. 编写其余组件"></a>5. 编写其余组件</h3><p>其他组件, 虽然各自逻辑 不一样, 但是套路是差不多的, 经过我的努力奋斗, 完成了以下 组件, 下面重点说一些值得说的点</p>
<ul>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%99%AE%E9%80%9A&selectedStory=Button%20%E6%8C%89%E9%92%AE&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Button 按钮</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Alert%20%E8%AD%A6%E5%91%8A%E6%8F%90%E7%A4%BA&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Alert  警告提示</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%AF%BC%E8%88%AA&selectedStory=Breadcrumb%20%E9%9D%A2%E5%8C%85%E5%B1%91&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Breadcrumb 面包屑</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%B8%83%E5%B1%80&selectedStory=Grid%20%E6%A0%85%E6%A0%8F&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Grid 网格布局</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=Input%20%E8%BE%93%E5%85%A5%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Input 输入框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Message%20%E6%B6%88%E6%81%AF%E6%8F%90%E7%A4%BA&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Message 消息提示</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Modal%20%E5%AF%B9%E8%AF%9D%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Modal 对话框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%AF%BC%E8%88%AA&selectedStory=Pagination%20%E5%88%86%E9%A1%B5%E5%99%A8&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Pagination 分页器</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Tooltip&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Tooltip 文字提示</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%A8%B1%E4%B9%90&selectedStory=TurnTable%20%E6%8A%BD%E5%A5%96%E8%BD%AC%E7%9B%98&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">TurnTable 抽奖转盘</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=WordPad%20%E5%86%99%E5%AD%97%E6%9D%BF&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">WordPad   手写输入板</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%A8%B1%E4%B9%90&selectedStory=MusicPlayer%20%E9%9F%B3%E4%B9%90%E6%92%AD%E6%94%BE%E5%99%A8&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">MusicPlayer 响应式音乐播放器</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Spin%20%E5%8A%A0%E8%BD%BD%E4%B8%AD&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Spin  加载中</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%85%B6%E4%BB%96&selectedStory=BackTop%20%E5%9B%9E%E5%88%B0%E9%A1%B6%E9%83%A8&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">BackTop 回到顶部</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Progress%20%E8%BF%9B%E5%BA%A6%E6%9D%A1&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Progress  进度条</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Tabs%20%E9%80%89%E9%A1%B9%E5%8D%A1&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Tabs  选项卡</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Badge%20%E5%BE%BD%E6%A0%87%E6%95%B0&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Badge   徽标数</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%AF%BC%E8%88%AA&selectedStory=Dropdown%20%E4%B8%8B%E6%8B%89%E8%8F%9C%E5%8D%95&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Dropdown 下拉菜单</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Drawer%20%E6%8A%BD%E5%B1%89&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Drawer 抽屉</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=Radio%20%E5%8D%95%E9%80%89%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Radio   单选框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%B8%83%E5%B1%80&selectedStory=Container%20%E5%8C%85%E8%A3%B9%E5%AE%B9%E5%99%A8&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Container 包裹容器</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%AF%BC%E8%88%AA&selectedStory=Affix%20%E5%9B%BA%E9%92%89&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Affix  固钉</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Timeline%20%E6%97%B6%E9%97%B4%E8%BD%B4&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Timeline  时间轴</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=Checkbox%20%E5%A4%8D%E9%80%89%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Checkbox  复选框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=Switch%20%E5%BC%80%E5%85%B3&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Switch  开关</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Tag%20%E6%A0%87%E7%AD%BE&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Tag 标签</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=CityPicker%20%E5%9F%8E%E5%B8%82%E9%80%89%E6%8B%A9%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">CityPicker  城市选择框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Collapse%20%E6%8A%98%E5%8F%A0%E9%9D%A2%E6%9D%BF&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Collapse  折叠面板</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=Select%20%E9%80%89%E6%8B%A9%E5%99%A8&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Select  下拉选择器</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=DatePicker%20%E6%97%A5%E6%9C%9F%E9%80%89%E6%8B%A9%E5%99%A8&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">DatePicker  日历选择框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%93%8D%E4%BD%9C%E5%8F%8D%E9%A6%88&selectedStory=Notification%20%E9%80%9A%E7%9F%A5%E6%8F%90%E9%86%92%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Notification  通知提醒框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=NumberInput%20%E8%BE%93%E5%85%A5%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">NumberInput  数字输入框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E5%AF%BC%E8%88%AA&selectedStory=Steps%20%E6%AD%A5%E9%AA%A4%E6%9D%A1&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Steps  步骤条</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%BD%95%E5%85%A5&selectedStory=Upload%20%E4%B8%8A%E4%BC%A0&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Upload  上传</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Calendar%20%E6%97%A5%E5%8E%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Calendar  日历</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Popover%20%E6%B0%94%E6%B3%A1%E5%8D%A1%E7%89%87&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Popover  气泡卡片</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Popconfirm%20%E6%B0%94%E6%B3%A1%E7%A1%AE%E8%AE%A4%E6%A1%86&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">PopConfirm  气泡确认框</a></li>
<li><input checked="" disabled="" type="checkbox"> <a href="https://cuke-ui.github.io/cuke-ui/?selectedKind=%E6%95%B0%E6%8D%AE%E5%B1%95%E7%A4%BA&selectedStory=Card%20%E5%8D%A1%E7%89%87&full=0&addons=1&stories=1&panelRight=0&addonPanel=storybook%2Factions%2Factions-panel" target="_blank" rel="noopener">Card 卡片</a></li>
</ul>
<h4 id="5-1-消息提示类-组件"><a href="#5-1-消息提示类-组件" class="headerlink" title="5.1 消息提示类 组件"></a>5.1 消息提示类 组件</h4><blockquote>
<p>message, notification</p>
</blockquote>
<p>理想的状态 是 直接用 api 的方式调用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import &#123; message &#125; from &#39;cuke-ui&#39;</span><br><span class="line">message.success(&#39;xxx&#39;)</span><br></pre></td></tr></table></figure>

<p>利用 <code>class static</code>  静态属性 轻松实现这一点</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> renderElement = <span class="function">(<span class="params">type, title, duration, onClose, darkTheme</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> container = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</span><br><span class="line">    <span class="keyword">const</span> currentNode = <span class="built_in">document</span>.body.appendChild(container);</span><br><span class="line">    <span class="keyword">const</span> _message = ReactDOM.render(</span><br><span class="line">      &lt;Message</span><br><span class="line">        type=&#123;type&#125;</span><br><span class="line">        title=&#123;title&#125;</span><br><span class="line">        darkTheme=&#123;darkTheme&#125;</span><br><span class="line">        duration=&#123;duration&#125;</span><br><span class="line">        onClose=&#123;onClose&#125;</span><br><span class="line">      /&gt;,</span><br><span class="line">      container</span><br><span class="line">    );</span><br><span class="line">    <span class="keyword">if</span> (_message) &#123;</span><br><span class="line">      _message._containerRef = container;</span><br><span class="line">      _message._currentNodeRef = currentNode;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        destroy: _message.destroy</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      destroy: <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">static</span> error(title, duration, onClose, darkTheme) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.renderElement(<span class="string">"error"</span>, title, duration, onClose, darkTheme);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> info(title, duration, onClose, darkTheme) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.renderElement(<span class="string">"info"</span>, title, duration, onClose, darkTheme);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> success(title, duration, onClose, darkTheme) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.renderElement(<span class="string">"success"</span>, title, duration, onClose, darkTheme);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> warning(title, duration, onClose, darkTheme) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.renderElement(<span class="string">"warning"</span>, title, duration, onClose, darkTheme);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> loading(title, duration, onClose, darkTheme) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.renderElement(<span class="string">"loading"</span>, title, duration, onClose, darkTheme);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>把每一个 类 的 static 方法 当做一个 api, 然后调用 <code>api</code> 时, 在 body 创建一个 ‘div’, 通过 <code>ReactDOM.render</code> 方法 渲染出来</p>
<h4 id="5-2-弹窗提示类-组件"><a href="#5-2-弹窗提示类-组件" class="headerlink" title="5.2 弹窗提示类 组件"></a>5.2 弹窗提示类 组件</h4><blockquote>
<p>Modal</p>
</blockquote>
<p>在 <code>react-dom</code> 提供了 <code>createPortal</code> api 后, 编写 弹窗类组件 变得 异常简单, 也就是通过所谓的传送门, 将 dom 挂载 在 body 下面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  return createPortal(</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;mask&quot;&#x2F;&gt;</span><br><span class="line">      &lt;div class&#x3D;&quot;modal&quot;&#x2F;&gt;</span><br><span class="line">    &lt;&#x2F;&gt;,</span><br><span class="line">    document.body</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-150550@2x.png" alt="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-150550@2x.png"></p>
<blockquote>
<p>Tooltip</p>
</blockquote>
<p><code>Tooltip</code> 实现有两种选择, 一种直接 绝对定位在 父元素, 这样会少一些 计算代码, 但是会带来一个问题</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> &lt;span</span><br><span class="line">  ref=&#123;<span class="keyword">this</span>.triggerWrapper&#125;</span><br><span class="line">  className=&#123;cls(<span class="string">`<span class="subst">$&#123;prefixCls&#125;</span>-trigger-wrapper`</span>)&#125;</span><br><span class="line">&gt;</span><br><span class="line">  &#123;<span class="keyword">this</span>.props.children&#125;</span><br><span class="line">&lt;<span class="regexp">/span&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果 父元素 有 <code>overflow:hidden</code> 之类的属性 <code>tooltip</code> 可能会被截取一部份, 所以采用第二种方案, 挂载在 <code>body</code> 上 通过</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">this.triggerWrapper &#x3D; React.createRef();</span><br><span class="line">const &#123;</span><br><span class="line">  width,</span><br><span class="line">  height,</span><br><span class="line">  top,</span><br><span class="line">  left</span><br><span class="line">&#125; &#x3D; this.triggerWrapper.current.getBoundingClientRect();</span><br></pre></td></tr></table></figure>

<p>拿到当前 的 位置信息 , 动态赋给 当前 <code>div</code>, 最后 绑定一个  <code>resize</code> 事件, 解决 窗口改变之后 位置不对的问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">componentWillUnmount() &#123;</span><br><span class="line">  window.removeEventListener(&quot;click&quot;, this.onClickOutsideHandler, false);</span><br><span class="line">  window.removeEventListener(&quot;resize&quot;, this.onResizeHandler);</span><br><span class="line">  this.closeTimer &#x3D; undefined;</span><br><span class="line">&#125;</span><br><span class="line">componentDidMount() &#123;</span><br><span class="line">  window.addEventListener(&quot;click&quot;, this.onClickOutsideHandler, false);</span><br><span class="line">  window.addEventListener(&quot;resize&quot;, this.onResizeHandler);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5-3-初始化动画闪烁问题"><a href="#5-3-初始化动画闪烁问题" class="headerlink" title="5.3 初始化动画闪烁问题"></a>5.3 初始化动画闪烁问题</h4><p>在 很多 组件 需要淡入淡出动画时 我会绑定两个 class , 对应淡入和淡出的 动画</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"> state &#x3D; &#123;</span><br><span class="line">    visible: false</span><br><span class="line"> &#125;</span><br><span class="line"> &lt;div</span><br><span class="line">    className&#x3D;&#123;cls(&#96;$&#123;prefixCls&#125;-content&#96;, &#123;</span><br><span class="line">      [&#96;$&#123;prefixCls&#125;-open&#96;]: visible,</span><br><span class="line">      [&#96;$&#123;prefixCls&#125;-close&#96;]: !visible,</span><br><span class="line">      [&quot;cuke-ui-no-animate&quot;]: visible &#x3D;&#x3D;&#x3D; null</span><br><span class="line">    &#125;)&#125;</span><br><span class="line">    ref&#x3D;&#123;this.wrapper&#125;</span><br><span class="line">    style&#x3D;&#123;&#123;</span><br><span class="line">      width,</span><br><span class="line">      left,</span><br><span class="line">      top</span><br><span class="line">    &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; xx.less</span><br><span class="line">  &amp;-open &#123;</span><br><span class="line">    animation: cuke-picker-open @default-transition forwards;</span><br><span class="line">  &#125;</span><br><span class="line">  &amp;-close &#123;</span><br><span class="line">    animation: cuke-picker-close @default-transition forwards;</span><br><span class="line">    pointer-events: none;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .cuke-ui-no-animate &#123;</span><br><span class="line">    animation: none !important;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>这时候会出现一个问题, 在初始化的时候 因为 visible 默认是 <code>false</code> 所以 会执行 close 动画 , 导致 闪烁, 所以 只需要 初始化 把 state 设为 <code>null</code>, 当 null 时 将 css 设为 <code>animation:none</code> 就解决了</p>
<h4 id="5-4-统一的视觉风格"><a href="#5-4-统一的视觉风格" class="headerlink" title="5.4 统一的视觉风格"></a>5.4 统一的视觉风格</h4><p>为了以后维护 和 换肤, 需要维护一份统一的变量, 所有组件统一引用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;vars.less</span><br><span class="line">@primary-color: #31c27c;</span><br><span class="line">@warning-color: #fca130;</span><br><span class="line">@error-color: #f93e3e;</span><br><span class="line">@success-color: #35C613;</span><br><span class="line">@info-color: #61affe;</span><br><span class="line">@bg-color: #FAFAFA;</span><br><span class="line">@border-color: #e8e8e8;</span><br><span class="line">@label-color: #333;</span><br><span class="line">@default-color: #d9d9d9;</span><br><span class="line">@loading-color: #61affe;</span><br><span class="line">@font-color: rgba(0, 0, 0, .65);</span><br><span class="line">@disabled-color: #f5f5f5;</span><br><span class="line">@disabled-font-color: fade(@font-color, 25%);</span><br><span class="line">@font-size: 14px;</span><br><span class="line">@border-radius: 4px;</span><br><span class="line">@default-shadow: 0 4px 22px 0 rgba(15, 35, 95, 0.12);</span><br><span class="line">@default-section-shadow: 0 1px 4px 0 rgba(15, 35, 95, 0.12);</span><br><span class="line">@default-text-shadow: 0 1px 0 rgba(0, 0, 0, .1);</span><br><span class="line">@picker-offset-top: 5px;</span><br><span class="line">@mask-bg-color: rgba(0, 0, 0, .5);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 响应式断点</span><br><span class="line">@media-screen-xs-max : 576px;</span><br><span class="line">@mobile: ~ &quot;screen and (max-width: @&#123;media-screen-xs-max&#125;)&quot;;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;动画时间</span><br><span class="line">@loading-time: 1.5s;</span><br><span class="line">@loading-opacity: .7;</span><br><span class="line">@animate-time : .5s;</span><br><span class="line">@animate-type: cubic-bezier(0.165, 0.84, 0.44, 1);</span><br><span class="line">@animate-type-easy-in-out: cubic-bezier(.9, .25, .08, .83);</span><br><span class="line">@default-transition: @animate-time @animate-type;</span><br></pre></td></tr></table></figure>

<h4 id="5-5-巧用-React-cloneElement"><a href="#5-5-巧用-React-cloneElement" class="headerlink" title="5.5 巧用 React.cloneElement"></a>5.5 巧用 React.cloneElement</h4><p>在 编写组件的时候,经常配到需要配套的 问题, 比如 <code>Collapse</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Collapse rightArrow&gt;</span><br><span class="line">    &lt;Collapse.Item title&#x3D;&quot;1&quot;&gt;1&lt;&#x2F;Collapse.Item&gt;</span><br><span class="line">    &lt;Collapse.Item title&#x3D;&quot;2&quot;&gt;2&lt;&#x2F;Collapse.Item&gt;</span><br><span class="line">    &lt;Collapse.Item title&#x3D;&quot;3&quot;&gt;3&lt;&#x2F;Collapse.Item&gt;</span><br><span class="line">&lt;&#x2F;Collapse&gt;</span><br></pre></td></tr></table></figure>

<p><code>&lt;Collapse&gt;</code> 和 <code>&lt;Collapse.Item&gt;</code> 都是我们提供给用户的 组件 需要配套使用, 比如上面的例子 , 有一个 <code>rightArrow</code> 属性 告诉每个 <code>&lt;Collapse.Item&gt;</code> 箭头都在右边, 这时候就需要 通过 <code>cloneElement</code> 传值给 子组件</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// collapse.js</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">const</span> items = React.Children.map(children, (element, index) =&gt; &#123;</span><br><span class="line">      <span class="keyword">return</span> React.cloneElement(element, &#123;</span><br><span class="line">        key: index,</span><br><span class="line">        accordion,</span><br><span class="line">        rightArrow,</span><br><span class="line">        activeKey: <span class="built_in">String</span>(index),</span><br><span class="line">        disabled: element.props.disabled, <span class="attr">hideArrow</span>: element.props.hideArrow</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;);</span><br></pre></td></tr></table></figure>

<p>每个子组件 在拿到 父组件的 <code>rightArrow</code> 属性后 就可以设置对应的 class , 类似的 <code>Row</code> <code>Col</code>, <code>Timeline</code> 实现方式都是如此</p>
<p>Ï</p>
<h4 id="5-6-getDerivedStateFromProps"><a href="#5-6-getDerivedStateFromProps" class="headerlink" title="5.6 getDerivedStateFromProps"></a>5.6 getDerivedStateFromProps</h4><p>在很多组件 都有类似的场景 state 需要依赖 props 的某一个属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Tabs activeKey&#x3D;&quot;1&quot;&gt;</span><br><span class="line">  &lt;Tabs.TabPane tab&#x3D;&quot;选项1&quot; key&#x3D;&quot;1&quot;&gt;</span><br><span class="line">    1</span><br><span class="line">  &lt;&#x2F;Tabs.TabPane&gt;</span><br><span class="line">  &lt;Tabs.TabPane tab&#x3D;&quot;选项2&quot; key&#x3D;&quot;2&quot;&gt;</span><br><span class="line">    2</span><br><span class="line">  &lt;&#x2F;Tabs.TabPane&gt;</span><br><span class="line">  &lt;Tabs.TabPane tab&#x3D;&quot;选项3&quot; key&#x3D;&quot;3&quot;&gt;</span><br><span class="line">    3</span><br><span class="line">  &lt;&#x2F;Tabs.TabPane&gt;</span><br><span class="line">&lt;&#x2F;Tabs&gt;</span><br></pre></td></tr></table></figure>

<p>比如上面这个 <code>Tabs</code> 组件 接受 一个 <code>activeKey</code> 来 渲染当前是 哪一个选项, 组件可能长这样</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Steps</span> <span class="keyword">extends</span> <span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">  state = &#123;</span><br><span class="line">    activeKey: ~~(<span class="keyword">this</span>.props.activeKey || <span class="keyword">this</span>.props.defaultActiveKey)</span><br><span class="line">  &#125;;</span><br><span class="line">   onTabChange = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">     <span class="keyword">this</span>.setState(&#123; <span class="attr">activeKey</span>: key &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

<p>初始 有一个 <code>activeKey</code> 记录当前的索引,每次点击 改变 索引值, 这时候就会有一个问题, 如果 props 的 <code>activeKey</code> 更新了, 这时候 state 不会更新, 所以需要用到 <code>getDerivedStateFromProps</code> 这个生命周期, 在每次 props 改变之后 比较 props 和 state 的 <code>activeKey</code> 是否一样, 如果不一样 则更新</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> getDerivedStateFromProps(&#123; activeKey &#125;, state) &#123;</span><br><span class="line">   <span class="keyword">if</span> (activeKey !== state.activeKey) &#123;</span><br><span class="line">     <span class="keyword">return</span> &#123;</span><br><span class="line">       activeKey</span><br><span class="line">     &#125;;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>


<h3 id="6-使用-antd-landing-生成一个-网站首页"><a href="#6-使用-antd-landing-生成一个-网站首页" class="headerlink" title="6. 使用 antd-landing 生成一个 网站首页"></a>6. 使用 antd-landing 生成一个 网站首页</h3><p>经过不断的努力改造, 组件倒是开发的差不多的, 但是还差一个 像 <a href="https://ant.design/index-cn" target="_blank" rel="noopener">https://ant.design/index-cn</a> 这样酷炫的首页, 通过一番搜寻, 发现了 <a href="https://landing.ant.design/index-cn" target="_blank" rel="noopener">antd-landing</a>  拖拖拽拽, 可视化的搭建好了 网站首页</p>
<p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-155908@2x.png" alt="landing"></p>
<p>最后 只需要 手写一些 webpack 配置 , 打包好发布到 <code>github page</code> 即可</p>
<h3 id="7-结语"><a href="#7-结语" class="headerlink" title="7. 结语"></a>7. 结语</h3><p>没错, 又是一个 类 <code>antd</code> 的库, 也许没啥意义, 通过这个 组件库, 我学到了很多 平时 接触不到的知识点, 也体会到了平时 框架,库作者的辛苦, 真心不容易, 吃力不讨好, 也得到了 <code>偏右</code> 等大佬 的 star, 同事也很热心的帮我提了一些 <code>Bug fix</code> 的 <code>PR</code>, 不管怎么说, 今年的学习目标完成了, 还是美滋滋的, 明年一月份 开始 搞 <code>nest</code> 和 <code>flutter</code> 了, 加油吧 骚猪</p>
<p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-162352@2x.png" alt="landing"></p>
<p><img src="https://lijinke666.github.io/lijinkeWeb-static/images/WX20181226-162242@2x.png" alt="landing"></p>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2019-01-31</span><i class="fa fa-comment-o"></i><a href="/2019/01/31/cuke-ui/#comments">评论</a><i class="fa fa-tag"></i><a class="tag" href="/tags/cuke-ui-react/" title="cuke-ui,react">cuke-ui,react </a></div></div></div></div><div style="margin:30px"><span class="leancloud-visitors" id="/2019/01/31/cuke-ui/"><span class="post-meta-item-text" style="margin-right:5px">阅读量</span><i class="leancloud-visitors-count">1000000</i></span></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" href="http://twitter.com/home?status=,https://www.lijinke.cn/2019/01/31/cuke-ui/,李金珂的小屋,黄瓜 ui -  一个 即插即用的 React UI 组件库,;" target="_blank" rel="noopener"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2019/01/31/%E5%88%9D%E8%AF%86-Web-Component/" title="初识 Web Component">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2018/06/27/MediaStream-%E5%AE%9E%E7%8E%B0%E5%B8%A6%E6%91%84%E5%83%8F%E5%A4%B4%E6%8D%95%E6%8D%89%E7%9A%84%E8%A1%A8%E6%83%85%E5%8C%85%E5%88%B6%E4%BD%9C%E5%99%A8/" title="MediaStream 实现带摄像头捕捉的表情包制作器">下一篇</a></li></ul></div><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/gh/xcss/valine@v1.1.7/dist/Valine.min.js?v=undefined"></script><script>var valine = new Valine({
  el:'#vcomments',
  //- notify:true || false,
  //- verify:true|| false,
  notify: true,
  verify: true,
  enableQQ: true,
  recordIP: true,
  app_id:'RBh7EcHesd4twgP5qIos38HM-gzGzoHsz',
  app_key:'f47a9Cg5ea9EVoPSs4KqfE6U',
  placeholder:'留下点什么?',
  path: window.location.pathname,
  avatar:'robohash',
  visitor: true,
})</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="/pwa.js"></script><script src="/main.js"></script></body></html>