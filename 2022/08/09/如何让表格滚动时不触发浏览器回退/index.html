<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="李金珂,jkli@thoughtworks.com"><title>如何让表格滚动时不触发浏览器回退 · 李金珂的小屋</title><meta name="description" content="背景小李的老板想要看下最近公司的数据，机智的小李用了一首歌的时间，使用 S2 快速的搭建了一个透视表将报表链接发给了老板。
第二天，老板秘书把小李叫进了会议室，说老板昨天使用报表后暴跳如雷，让小李赶紧想办法解决一下，不然只能就地结算一下工资走人了！小李吓得不轻，仔细看了下秘书发的视频，原来是老板使用"><meta name="keywords" content="Javascript,Node.js"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="李金珂的小屋"><meta name="icon" content="/logos/logo_192.png"><meta name="apple-touch-icon" content="/logos/logo_192.png"><meta name="apple-touch-icon-precomposed" content="/logos/logo_192.png"><meta name="apple-touch-startup-image" content="/logos/logo_192.png"><meta name="Alipay:title" content="李金珂的小屋"><meta name="Alipay:imgUrl" content="/logos/logo_192.png"><meta name="Alipay:desc" content="要想学仙术哪能不吃苦"><meta name="renderer" content="webkit"><meta name="theme-color" content="#fff"><link rel="short icon" href="/logos/logo_192.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"><link rel="manifest" href="/manifest.json"><meta name="generator" content="Hexo 5.4.0"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/my.jpeg" style="width:127px;border-radius:50%;margin-bottom:20px;"><h3 title=""><a href="/">李金珂的小屋</a></h3><div class="description"><p>要想学仙术,哪能不吃苦</p></div></div></div><ul class="social-links"><li><a target="_blank" rel="noopener" href="http://weibo.com/金珂珂珂珂"><i class="fa fa-weibo"></i></a></li><li><a target="_blank" rel="noopener" href="http://github.com/lijinke666"><i class="fa fa-github"></i></a></li></ul><div class="switch"><input type="checkbox" id="time"><label for="time">Night</label></div><div class="footer"><a target="_blank" href="/"><span>Theme by</span></a><a target="_blank" rel="noopener" href="https://www.caicai.me"> CaiCai</a><span>&</span><a target="_blank" rel="noopener" href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a><a href="https://beian.miit.gov.cn/" target="_blank">蜀ICP备17033638号</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">主页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友情链接</a></li></div><div class="information"><div class="back_btn"><li><a class="fa fa-chevron-left" onclick="window.history.go(-1)"> </a></li></div><div class="avatar"><img src="/images/my.jpeg"></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a>如何让表格滚动时不触发浏览器回退</a></h3></div><div class="post-content"><p><a name="oBKDo"></a></p>
<h3 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h3><p>小李的老板想要看下最近公司的数据，机智的小李用了一首歌的时间，使用 <a target="_blank" rel="noopener" href="https://github.com/antvis/S2">S2</a> 快速的搭建了一个<strong>透视表</strong>将报表链接发给了老板。</p>
<p>第二天，老板秘书把小李叫进了会议室，说老板昨天使用报表后暴跳如雷，让小李赶紧想办法解决一下，不然只能就地结算一下工资走人了！小李吓得不轻，仔细看了下秘书发的视频，原来是老板使用的是 Mac 电脑，每次用触摸板横向滚动时总是会触发<strong>浏览器的回退</strong>体验极差。<br /></p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2022/gif/6356643/1659942803130-f30063d2-aeac-4f83-8bc0-7c97468a830c.gif#clientId=u7e9c3550-0500-4&crop=0&crop=0&crop=1&crop=1&from=drop&height=506&id=u32cce9ca&margin=%5Bobject%20Object%5D&name=Kapture%202022-08-08%20at%2015.12.28.gif&originHeight=840&originWidth=744&originalType=binary&ratio=1&rotation=0&showTitle=false&size=852849&status=done&style=none&taskId=u3747d01e-3a32-4786-a39c-8538e0f7f50&title=&width=448" alt="Kapture 2022-08-08 at 15.12.28.gif"></p>
<p><a name="gthcu"></a></p>
<h3 id="问题出在哪呢？"><a href="#问题出在哪呢？" class="headerlink" title="问题出在哪呢？"></a>问题出在哪呢？</h3><p>小李发现如果通过拖拽滚动条，不会触发浏览器后退，那么问题应该是出在滚动事件上<br /></p>
<p><img src="https://intranetproxy.alipay.com/skylark/lark/0/2022/gif/6356643/1659944377504-32673fb7-3c1f-4f2a-b003-264faf9457bd.gif#clientId=u7e9c3550-0500-4&crop=0&crop=0&crop=1&crop=1&from=drop&height=377&id=u033f368f&margin=%5Bobject%20Object%5D&name=Kapture%202022-08-08%20at%2015.39.11.gif&originHeight=624&originWidth=744&originalType=binary&ratio=1&rotation=0&showTitle=false&size=1033007&status=done&style=none&taskId=u0a748fd9-918f-4f65-92eb-cebf037a630&title=&width=449" alt="Kapture 2022-08-08 at 15.39.11.gif"><br />小李了解到他使用的 <code>S2</code> 透视表，使用的是 <a target="_blank" rel="noopener" href="https://juejin.cn/post/7072926133859123236#heading-9">虚拟滚动技术</a>, 通过监听容器的 <code>wheel</code> 事件来做的一个按需加载，本质上还是用到了浏览器的滚动事件，而滚动条是模拟的，而非浏览器的滚动条，只会进行一个位置的同步，不涉及浏览器的滚动事件，那么问题应该就是出在 <code>wheel</code> 上，会不会触发了什么浏览器的默认行为呢？</p>
<p><a name="vOQJy"></a></p>
<h3 id="浏览器滚动默认行为"><a href="#浏览器滚动默认行为" class="headerlink" title="浏览器滚动默认行为"></a>浏览器滚动默认行为</h3><p>小李回想他日常遇到的一些浏览器默认行为，如：</p>
<ul>
<li><code>&lt;a&gt;</code> 超链接跳转</li>
<li><code>InputElement.focus()</code> 元素聚焦默认滚动到对应位置</li>
<li>子父容器同时<strong>存在滚动条，</strong>子容器在滚动到底/顶部时，同时触发父容器的滚动</li>
</ul>
<p>这些行为我们都可以通过 <code>preventDefault()</code> 或是 <code>&#123; preventScroll: true &#125;</code> 来解决</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">event.preventDefault();</span><br><span class="line"></span><br><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">&#x27;input&#x27;</span>).focus(&#123; <span class="attr">preventScroll</span>: <span class="literal">true</span> &#125;);</span><br></pre></td></tr></table></figure>

<p>看起来 Mac 上滚动触发浏览器回退也是一种浏览器默认事件，机智的小李一番搜索，发现了一个叫 <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/overscroll-behavior">overscroll-behavior</a> 的属性，<strong>可以控制浏览器滚动到边界的行为</strong></p>
<blockquote>
<p>We also wanted to get rid of the standard overscroll effects when the contacts are scrolled to the top or bottom (e.g. Chrome on Android refreshes the page when you scroll past the top boundary). This can be prevented by setting overscroll-behavior: none on the <a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/html"><html></a> element:</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">html &#123; overscroll-behavior: none; &#125;</span><br></pre></td></tr></table></figure>

<p>果不其然，在给 <code>html</code>设置 <code>overscroll-behavior: none</code> 后，老板的手指都磨烂了，也不会再触发浏览器的回退，小李长舒了一口气。 <a name="WKXzK"></a></p>
<h3 id=""><a href="#" class="headerlink" title=""></a><img src="https://intranetproxy.alipay.com/skylark/lark/0/2022/gif/6356643/1659946457244-b94ca337-2d9a-46da-9056-baf55fda8355.gif#clientId=u7e9c3550-0500-4&crop=0&crop=0&crop=1&crop=1&from=drop&height=476&id=u334963cd&margin=%5Bobject%20Object%5D&name=Kapture%202022-08-08%20at%2016.13.26.gif&originHeight=1442&originWidth=1324&originalType=binary&ratio=1&rotation=0&showTitle=false&size=860394&status=done&style=none&taskId=ua4c1dea7-38c8-41bf-aca0-5277b51e7b3&title=&width=437" alt="Kapture 2022-08-08 at 16.13.26.gif"></h3><p><a name="D6X3Y"></a></p>
<h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h3><p><a target="_blank" rel="noopener" href="https://github.com/antvis/s2">AntV/S2</a> 是多维交叉分析领域的表格解决方案。如果看完这篇文章你有所收获，欢迎给我们的 <a target="_blank" rel="noopener" href="https://github.com/antvis/s2">仓库</a> <a target="_blank" rel="noopener" href="https://github.com/antvis/s2">Star⭐️</a> 鼓励。</p>
<p>S2 相关链接：</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://github.com/antvis/s2">GitHub</a></li>
<li><a target="_blank" rel="noopener" href="https://s2.antv.vision/">官网</a></li>
</ul>
<p><a name="v0ZFm"></a></p>
<h3 id="往期文章"><a href="#往期文章" class="headerlink" title="往期文章"></a>往期文章</h3><ul>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7080471587249455135">你不知道的 Canvas 表格交互</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7094509003241160712">让你的表格更多彩 - AntV/S2 主题介绍</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7084064083279872014">AntV/S2 和 Antd Table 有什么区别？</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7106314606150156324">我用 AntV/S2 买了一套房</a></li>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/7072926133859123236#comment">如何基于 AntV S2 打造大数据表格组件</a></li>
</ul>
<p><a name="CrZBB"></a></p>
<h3 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h3><ul>
<li><a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/CSS/overscroll-behavior">MDN overscroll-behavior</a></li>
<li><a target="_blank" rel="noopener" href="https://www.zhangxinxu.com/wordpress/2020/01/css-overscroll-behavior/">CSS overscroll-behavior 让滚动嵌套时父滚动不触发</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/antvis/S2">S2</a></li>
</ul>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2022-08-09</span><i class="fa fa-comment-o"></i><a href="/2022/08/09/%E5%A6%82%E4%BD%95%E8%AE%A9%E8%A1%A8%E6%A0%BC%E6%BB%9A%E5%8A%A8%E6%97%B6%E4%B8%8D%E8%A7%A6%E5%8F%91%E6%B5%8F%E8%A7%88%E5%99%A8%E5%9B%9E%E9%80%80/#comments">评论</a><i class="fa fa-tag"></i><a class="tag" href="/tags/Canvas/" title="Canvas">Canvas </a></div></div></div></div><div style="margin:30px"><span class="leancloud-visitors" id="/2022/08/09/如何让表格滚动时不触发浏览器回退/"><span class="post-meta-item-text" style="margin-right:5px">阅读量</span><i class="leancloud-visitors-count">1000000</i></span></div><div class="share"><div class="evernote"><a class="fa fa-bookmark" href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank"></a></div><div class="weibo"><a class="fa fa-weibo" href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));"></a></div><div class="twitter"><a class="fa fa-twitter" target="_blank" rel="noopener" href="http://twitter.com/home?status=,https://www.lijinke.cn/2022/08/09/如何让表格滚动时不触发浏览器回退/,李金珂的小屋,如何让表格滚动时不触发浏览器回退,;"></a></div></div><div class="pagination"><ul class="clearfix"><li class="pre pagbuttons"><a class="btn" role="navigation" href="/2022/10/19/%E4%BD%BF%E7%94%A8-Github-Action-%E6%9D%A5%E5%81%9A%E8%87%AA%E5%8A%A8%E5%8C%96/" title="使用 Github Action 来做自动化">上一篇</a></li><li class="next pagbuttons"><a class="btn" role="navigation" href="/2022/06/21/%E5%A6%82%E4%BD%95%E7%BC%96%E5%86%99%E9%80%BC%E6%AD%BB%E5%BC%BA%E8%BF%AB%E7%97%87%E7%9A%84%E4%BB%A3%E7%A0%81/" title="如何编写逼死强迫症的代码">下一篇</a></li></ul></div><a id="comments"></a><div id="vcomments" style="margin:0 30px;"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine/dist/Valine.min.js?v=undefined"></script><script>var valine = new Valine({
  el:'#vcomments',
  //- notify: || false,
  //- verify:|| false,
  notify: true,
  verify: true,
  enableQQ: true,
  recordIP: true,
  app_id:'RBh7EcHesd4twgP5qIos38HM-gzGzoHsz',
  app_key:'f47a9Cg5ea9EVoPSs4KqfE6U',
  placeholder:'留下点什么?',
  path: window.location.pathname,
  avatar:'robohash',
  visitor: true,
})</script></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script><script src="https://unpkg.com/darkreader@4.9.32/darkreader.js"></script><script src="/pwa.js"></script><script src="/main.js"></script></body></html>